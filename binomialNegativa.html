<!doctype html><html lang="es"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Distribución Binomial Negativa</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="module">
  import { toNumber, negbinPMF, negbinCDF } from "./app.js?v=5";
  let chart;
  function draw(r, p, xMax){
    const ctx = document.getElementById("chart").getContext("2d");
    if(chart) chart.destroy();
    const xs = [], ys = [];
    for(let x=0; x<=xMax; x++){ xs.push(x); ys.push(negbinPMF(r,p,x)); }
    chart = new Chart(ctx, {
      type: "bar",
      data: { labels: xs, datasets: [{ label: "P(X=x)", data: ys }] },
      options: { scales: { y: { beginAtZero: true } } }
    });
  }
  window.calcular = ()=>{
    try{
      const r = toNumber(document.getElementById("r").value);
      const p = toNumber(document.getElementById("p").value);
      const x = toNumber(document.getElementById("x").value);
      const pmf = negbinPMF(r,p,x);
      const cdf = negbinCDF(r,p,x);
      document.getElementById("res").innerHTML =
        `<p>P(X = ${x}) = <b>${pmf.toFixed(6)}</b></p>
         <p>P(X ≤ ${x}) = <b>${cdf.toFixed(6)}</b></p>
         <p class="mt-2 text-gray-700">X = fracasos antes del r-ésimo éxito.</p>`;
      draw(r,p, Math.max(10,x));
    }catch(e){ document.getElementById("res").innerHTML = <p class="text-red-600">${e.message}</p>; }
  }
</script>
</head>
<body class="bg-gray-50 text-gray-800">
<header class="bg-indigo-600 text-white"><div class="max-w-5xl mx-auto p-5">
  <h1 class="text-2xl md:text-3xl font-bold">Distribución Binomial Negativa</h1>
  <p>Caso: # fracasos antes del r-ésimo éxito (p de éxito).</p>
</div></header>
<nav class="bg-white border-b"><div class="max-w-5xl mx-auto p-3 flex gap-2">
  <a class="px-3 py-2 rounded hover:bg-indigo-50" href="./index.html">Inicio</a>
</div></nav>
<main class="max-w-5xl mx-auto p-6 grid md:grid-cols-2 gap-6">
<section class="bg-white rounded-2xl shadow p-6">
  <h2 class="text-xl font-semibold mb-3">Teoría breve</h2>
  <ul class="list-disc pl-6 text-sm">
    <li>PMF: \( P(X=x)=\binom{x+r-1}{x}(1-p)^x p^r \)</li>
    <li>Modela conteos hasta lograr r éxitos.</li>
  </ul>
</section>
<section class="bg-white rounded-2xl shadow p-6">
  <h2 class="text-xl font-semibold mb-3">Cálculo</h2>
  <div class="grid grid-cols-3 gap-3">
    <label class="text-sm">r (éxitos) <input id="r" type="number" value="3" class="w-full mt-1 border rounded p-2"></label>
    <label class="text-sm">p (0–1) <input id="p" type="number" step="0.01" value="0.4" class="w-full mt-1 border rounded p-2"></label>
    <label class="text-sm">x (fracasos) <input id="x" type="number" value="2" class="w-full mt-1 border rounded p-2"></label>
  </div>
  <button onclick="calcular()" class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg">Calcular</button>
  <div id="res" class="mt-3 text-sm"></div>
</section>
<section class="bg-white rounded-2xl shadow p-6 md:col-span-2">
  <h2 class="text-xl font-semibold mb-3">Gráfica</h2>
  <canvas id="chart" height="120"></canvas>
</section>
</main>
</body></html>